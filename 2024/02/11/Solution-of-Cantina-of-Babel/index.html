<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/favicon.ico" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Jetbrains+Mono:300,300italic,400,400italic,700,700italic%7CHeiti:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha256-yIDrPSXHZdOZhAqiBP7CKzIwMQmRCJ8UeB8Jo17YC4o=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.28/fancybox/fancybox.css" integrity="sha256-6cQIC71/iBIYXFK+0RHAvwmjwWzkWd+r7v/BX3/vZDc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-material.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dawn-cmd.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.19.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Problem Descriptionlink Problem AnalysisWe can divide all people into different sets based on the languages they understand and speak. Everyone in a set can communicate with others in the same set—tha">
<meta property="og:type" content="article">
<meta property="og:title" content="Solution of Cantina of Babel">
<meta property="og:url" content="https://dawn-cmd.github.io/2024/02/11/Solution-of-Cantina-of-Babel/index.html">
<meta property="og:site_name" content="Developer Biography">
<meta property="og:description" content="Problem Descriptionlink Problem AnalysisWe can divide all people into different sets based on the languages they understand and speak. Everyone in a set can communicate with others in the same set—tha">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-02-11T23:08:33.000Z">
<meta property="article:modified_time" content="2024-02-11T23:11:55.946Z">
<meta property="article:author" content="HuaiYuan Jing">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://dawn-cmd.github.io/2024/02/11/Solution-of-Cantina-of-Babel/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://dawn-cmd.github.io/2024/02/11/Solution-of-Cantina-of-Babel/","path":"2024/02/11/Solution-of-Cantina-of-Babel/","title":"Solution of Cantina of Babel"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Solution of Cantina of Babel | Developer Biography</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Developer Biography" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Developer Biography</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">action speaks louder than word</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Problem-Description"><span class="nav-number">1.</span> <span class="nav-text">Problem Description</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Problem-Analysis"><span class="nav-number">2.</span> <span class="nav-text">Problem Analysis</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Step-1-Convert-Strings-to-IDs"><span class="nav-number">3.</span> <span class="nav-text">Step 1: Convert Strings to IDs</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Step-2-Construct-the-Language-Conversion-Graph"><span class="nav-number">4.</span> <span class="nav-text">Step 2: Construct the Language Conversion Graph</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Step-3-Verify-Two-People-Can-Communicate"><span class="nav-number">5.</span> <span class="nav-text">Step 3: Verify Two People Can Communicate</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Step-4-Construct-a-Disjoint-Set-Union"><span class="nav-number">6.</span> <span class="nav-text">Step 4: Construct a Disjoint Set Union</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Step-5-Obtain-the-Largest-DSU-Count"><span class="nav-number">7.</span> <span class="nav-text">Step 5: Obtain the Largest DSU Count</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Step-6-Integrate-and-Return-the-Answer"><span class="nav-number">8.</span> <span class="nav-text">Step 6: Integrate and Return the Answer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Conclusion-Complete-Code"><span class="nav-number">9.</span> <span class="nav-text">Conclusion: Complete Code</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="HuaiYuan Jing" src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">HuaiYuan Jing</p>
  <div class="site-description" itemprop="description">history of blood and tear</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">7</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/dawn-cmd" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;dawn-cmd" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:ls.hyjing@gmail.com" title="E-Mail → mailto:ls.hyjing@gmail.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
        <div class="pjax">
        </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://dawn-cmd.github.io/2024/02/11/Solution-of-Cantina-of-Babel/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="HuaiYuan Jing">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Developer Biography">
      <meta itemprop="description" content="history of blood and tear">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Solution of Cantina of Babel | Developer Biography">
      <meta itemprop="description" content>
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Solution of Cantina of Babel
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-02-11 17:08:33 / Modified: 17:11:55" itemprop="dateCreated datePublished" datetime="2024-02-11T17:08:33-06:00">2024-02-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DFS/" itemprop="url" rel="index"><span itemprop="name">DFS</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DFS/Disjoint-Union-Set/" itemprop="url" rel="index"><span itemprop="name">Disjoint Union Set</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DFS/Disjoint-Union-Set/ICPC/" itemprop="url" rel="index"><span itemprop="name">ICPC</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DFS/Disjoint-Union-Set/ICPC/Kattis/" itemprop="url" rel="index"><span itemprop="name">Kattis</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DFS/Disjoint-Union-Set/ICPC/Kattis/Connective/" itemprop="url" rel="index"><span itemprop="name">Connective</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="Problem-Description"><a href="#Problem-Description" class="headerlink" title="Problem Description"></a>Problem Description</h2><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://open.kattis.com/problems/cantinaofbabel">link</a></p>
<h2 id="Problem-Analysis"><a href="#Problem-Analysis" class="headerlink" title="Problem Analysis"></a>Problem Analysis</h2><p>We can divide all people into different sets based on the languages they understand and speak. Everyone in a set can communicate with others in the same set—that is, they can understand the languages spoken by each other. Finally, we subtract the number of people in the largest set from the total number of people, which gives us the minimum number of people that need to be excluded.</p>
<h2 id="Step-1-Convert-Strings-to-IDs"><a href="#Step-1-Convert-Strings-to-IDs" class="headerlink" title="Step 1: Convert Strings to IDs"></a>Step 1: Convert Strings to IDs</h2><p>All the information provided in the input appears in string form, which is extremely inconvenient for graph construction and traversal. Therefore, we first record strings and assign corresponding IDs using a dictionary and an array.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">build_language_dict</span>(people: &amp;<span class="type">Vec</span>&lt;Person&gt;) <span class="punctuation">-&gt;</span> HashMap&lt;&amp;<span class="type">String</span>, <span class="type">usize</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">lang_dict</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">num_of_lang</span> = <span class="number">0usize</span>;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">person</span> <span class="keyword">in</span> people &#123;</span><br><span class="line">        <span class="keyword">for</span> <span class="variable">lang</span> <span class="keyword">in</span> person.understand.<span class="title function_ invoke__">borrow</span>() &#123;</span><br><span class="line">            <span class="keyword">if</span> lang_dict.<span class="title function_ invoke__">contains_key</span>(lang) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            lang_dict.<span class="title function_ invoke__">insert</span>(lang, num_of_lang);</span><br><span class="line">            num_of_lang += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    lang_dict</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">record_people</span>(n: <span class="type">usize</span>) <span class="punctuation">-&gt;</span> <span class="type">Vec</span>&lt;Person&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">people</span>: <span class="type">Vec</span>&lt;Person&gt; = <span class="built_in">vec!</span>[];</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">_</span> <span class="keyword">in</span> <span class="number">0</span>..n &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">input</span> = <span class="title function_ invoke__">read_line_of_string</span>();</span><br><span class="line">        people.<span class="title function_ invoke__">push</span>(Person &#123;</span><br><span class="line">            speak: input[<span class="number">1</span>].<span class="title function_ invoke__">to_owned</span>(),</span><br><span class="line">            understand: HashSet::<span class="title function_ invoke__">new</span>(),</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">id</span> = people.<span class="title function_ invoke__">len</span>() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">1</span>..input.<span class="title function_ invoke__">len</span>() &#123;</span><br><span class="line">            people[id].understand.<span class="title function_ invoke__">insert</span>(input[i].<span class="title function_ invoke__">clone</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    people</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The <code>record_people</code> function records each line of input, then converts them into <code>Person</code> structs and stores them in the <code>people</code> array, allowing direct access to each person via their ID later. The <code>build_language_dict</code> function creates a <code>HashMap</code> with <code>String</code> keys and <code>usize</code> values, enabling us to find the corresponding value by language name. After converting all strings to IDs, we can begin constructing the graph.</p>
<h2 id="Step-2-Construct-the-Language-Conversion-Graph"><a href="#Step-2-Construct-the-Language-Conversion-Graph" class="headerlink" title="Step 2: Construct the Language Conversion Graph"></a>Step 2: Construct the Language Conversion Graph</h2><p>For each person, they can convert the languages they understand to the language they speak. This is equivalent to drawing a directed edge from the understood language to the spoken language. By traversing each person in this way, we can build a graph of language conversion.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">build_lang_graph</span>(people: &amp;<span class="type">Vec</span>&lt;Person&gt;, lang_dict: &amp;HashMap&lt;&amp;<span class="type">String</span>, <span class="type">usize</span>&gt;) <span class="punctuation">-&gt;</span> <span class="type">Vec</span>&lt;<span class="type">Vec</span>&lt;<span class="type">usize</span>&gt;&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">lang_graph</span>: <span class="type">Vec</span>&lt;<span class="type">Vec</span>&lt;<span class="type">usize</span>&gt;&gt; = <span class="built_in">vec!</span>[<span class="built_in">vec!</span>[]; lang_dict.<span class="title function_ invoke__">len</span>()];</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">person</span> <span class="keyword">in</span> people &#123;</span><br><span class="line">        <span class="keyword">for</span> <span class="variable">lang</span> <span class="keyword">in</span> person.understand.<span class="title function_ invoke__">borrow</span>() &#123;</span><br><span class="line">            <span class="keyword">if</span> *lang == person.speak &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            lang_graph[lang_dict[lang]].<span class="title function_ invoke__">push</span>(lang_dict[&amp;person.speak]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">0</span>..lang_graph.<span class="title function_ invoke__">len</span>() &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">tmp</span>: HashSet&lt;_&gt; = lang_graph[i].<span class="title function_ invoke__">drain</span>(..).<span class="title function_ invoke__">collect</span>();</span><br><span class="line">        lang_graph[i].<span class="title function_ invoke__">extend</span>(tmp.<span class="title function_ invoke__">into_iter</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    lang_graph</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The function’s end uses a <code>HashSet</code> for edge deduplication. Values in the array are placed into a <code>HashSet</code> and then back into the array to achieve deduplication.</p>
<h2 id="Step-3-Verify-Two-People-Can-Communicate"><a href="#Step-3-Verify-Two-People-Can-Communicate" class="headerlink" title="Step 3: Verify Two People Can Communicate"></a>Step 3: Verify Two People Can Communicate</h2><p>After the language graph is established, a function is needed to verify whether two people can understand each other’s spoken languages. If one person’s spoken language can be converted into one of the languages the other person understands, then it can be said that the second person can understand the first person’s speech, and vice versa. This is implemented using a naive DFS algorithm.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">test_connected_dfs</span>(</span><br><span class="line">    cur: <span class="type">usize</span>,</span><br><span class="line">    target: &amp;HashSet&lt;<span class="type">usize</span>&gt;,</span><br><span class="line">    lang_graph: &amp;<span class="type">Vec</span>&lt;<span class="type">Vec</span>&lt;<span class="type">usize</span>&gt;&gt;,</span><br><span class="line">    visited: &amp;<span class="keyword">mut</span> <span class="type">Vec</span>&lt;<span class="type">bool</span>&gt;,</span><br><span class="line">) <span class="punctuation">-&gt;</span> <span class="type">bool</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> target.<span class="title function_ invoke__">contains</span>(&amp;cur) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    visited[cur] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">next</span> <span class="keyword">in</span> &amp;lang_graph[cur] &#123;</span><br><span class="line">        <span class="keyword">if</span> visited[*next] &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> <span class="title function_ invoke__">test_connected_dfs</span>(*next, target, lang_graph, visited) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">test_biconnected</span>(</span><br><span class="line">    a: &amp;Person,</span><br><span class="line">    b: &amp;Person,</span><br><span class="line">    lang_graph: &amp;<span class="type">Vec</span>&lt;<span class="type">Vec</span>&lt;<span class="type">usize</span>&gt;&gt;,</span><br><span class="line">    lang_dict: &amp;HashMap&lt;&amp;<span class="type">String</span>, <span class="type">usize</span>&gt;,</span><br><span class="line">) <span class="punctuation">-&gt;</span> <span class="type">bool</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">visited</span> = <span class="built_in">vec!</span>[<span class="literal">false</span>; lang_graph.<span class="title function_ invoke__">len</span>()];</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">target</span>: HashSet&lt;<span class="type">usize</span>&gt; = b</span><br><span class="line">        .understand</span><br><span class="line">        .<span class="title function_ invoke__">borrow</span>()</span><br><span class="line">        .<span class="title function_ invoke__">into_iter</span>()</span><br><span class="line">        .<span class="title function_ invoke__">map</span>(|s| lang_dict[s])</span><br><span class="line">        .<span class="title function_ invoke__">collect</span>();</span><br><span class="line">    <span class="keyword">if</span> !<span class="title function_ invoke__">test_connected_dfs</span>(lang_dict[&amp;a.speak], &amp;target, lang_graph, &amp;<span class="keyword">mut</span> visited) &#123;</span><br><span class="line">       </span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    visited = <span class="built_in">vec!</span>[<span class="literal">false</span>; lang_graph.<span class="title function_ invoke__">len</span>()];</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">target</span>: HashSet&lt;<span class="type">usize</span>&gt; = a</span><br><span class="line">        .understand</span><br><span class="line">        .<span class="title function_ invoke__">borrow</span>()</span><br><span class="line">        .<span class="title function_ invoke__">into_iter</span>()</span><br><span class="line">        .<span class="title function_ invoke__">map</span>(|s| lang_dict[s])</span><br><span class="line">        .<span class="title function_ invoke__">collect</span>();</span><br><span class="line">    <span class="keyword">if</span> !<span class="title function_ invoke__">test_connected_dfs</span>(lang_dict[&amp;b.speak], &amp;target, lang_graph, &amp;<span class="keyword">mut</span> visited) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The <code>test_biconnected</code> function encapsulates <code>test_connected_dfs</code>. By calling this subfunction twice, it verifies whether two people can communicate.</p>
<h2 id="Step-4-Construct-a-Disjoint-Set-Union"><a href="#Step-4-Construct-a-Disjoint-Set-Union" class="headerlink" title="Step 4: Construct a Disjoint Set Union"></a>Step 4: Construct a Disjoint Set Union</h2><p>When analyzing the relationships between each person, a disjoint set union (DSU) data structure is used for organization. Everyone in a DSU can communicate with each other, and if two people from different DSUs can communicate, those DSUs are merged.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">DisjointSetUnion</span> &#123;</span><br><span class="line">    fa: <span class="type">Vec</span>&lt;<span class="type">usize</span>&gt;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">DisjointSetUnion</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">get_fa</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, cur: <span class="type">usize</span>) <span class="punctuation">-&gt;</span> <span class="type">usize</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">self</span>.fa[cur] == cur &#123;</span><br><span class="line">            <span class="keyword">return</span> cur;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">tmp</span> = <span class="keyword">self</span>.fa[cur];</span><br><span class="line">        <span class="keyword">self</span>.fa[cur] = <span class="keyword">self</span>.<span class="title function_ invoke__">get_fa</span>(tmp);</span><br><span class="line">        <span class="keyword">self</span>.fa[cur]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">build_people_disjoint_set_union</span>(</span><br><span class="line">    people: &amp;<span class="type">Vec</span>&lt;Person&gt;,</span><br><span class="line">    lang_graph: &amp;<span class="type">Vec</span>&lt;<span class="type">Vec</span>&lt;<span class="type">usize</span>&gt;&gt;,</span><br><span class="line">    lang_dict: &amp;HashMap&lt;&amp;<span class="type">String</span>, <span class="type">usize</span>&gt;,</span><br><span class="line">) <span class="punctuation">-&gt;</span> DisjointSetUnion &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">people_disjoint_set_union</span> = DisjointSetUnion &#123;</span><br><span class="line">        fa: (<span class="number">0</span>..people.<span class="title function_ invoke__">len</span>()).<span class="title function_ invoke__">into_iter</span>().<span class="title function_ invoke__">collect</span>(),</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">0</span>..people.<span class="title function_ invoke__">len</span>() &#123;</span><br><span class="line">        <span class="keyword">for</span> <span class="variable">j</span> <span class="keyword">in</span> i + <span class="number">1</span>..people.<span class="title function_ invoke__">len</span>() &#123;</span><br><span class="line">            <span class="keyword">if</span> people_disjoint_set_union.<span class="title function_ invoke__">get_fa</span>(i) == people_disjoint_set_union.<span class="title function_ invoke__">get_fa</span>(j)</span><br><span class="line">                || !<span class="title function_ invoke__">test_biconnected</span>(&amp;people[i], &amp;people[j], lang_graph, lang_dict)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">tmp</span> = people_disjoint_set_union.<span class="title function_ invoke__">get_fa</span>(i);</span><br><span class="line">            people_disjoint_set_union.fa[tmp] = people_disjoint_set_union.<span class="title function_ invoke__">get_fa</span>(j);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    people_disjoint_set_union</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Path compression is used in the DSU implementation. Each call to <code>get_fa</code> updates the node’s parent to the root node of the set, thereby flattening the DSU and optimizing query efficiency.</p>
<h2 id="Step-5-Obtain-the-Largest-DSU-Count"><a href="#Step-5-Obtain-the-Largest-DSU-Count" class="headerlink" title="Step 5: Obtain the Largest DSU Count"></a>Step 5: Obtain the Largest DSU Count</h2><p>An array records the count of each DSU, and each node’s DSU is identified using <code>get_fa</code>, updating the count accordingly. The function returns the count of the largest DSU.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> <span class="title class_">DisjointSetUnion</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">get_fa</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, cur: <span class="type">usize</span>) <span class="punctuation">-&gt;</span> <span class="type">usize</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">self</span>.fa[cur] == cur &#123;</span><br><span class="line">            <span class="keyword">return</span> cur;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">tmp</span> = <span class="keyword">self</span>.fa[cur];</span><br><span class="line">        <span class="keyword">self</span>.fa[cur] = <span class="keyword">self</span>.<span class="title function_ invoke__">get_fa</span>(tmp);</span><br><span class="line">        <span class="keyword">self</span>.fa[cur]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">get_largest_set</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">usize</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">num_of_set</span> = <span class="built_in">vec!</span>[<span class="number">0usize</span>; <span class="keyword">self</span>.fa.<span class="title function_ invoke__">len</span>()];</span><br><span class="line">        <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">0</span>..<span class="keyword">self</span>.fa.<span class="title function_ invoke__">len</span>() &#123;</span><br><span class="line">            num_of_set[<span class="keyword">self</span>.<span class="title function_ invoke__">get_fa</span>(i)] += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        *num_of_set.<span class="title function_ invoke__">iter</span>().<span class="title function_ invoke__">max</span>().<span class="title function_ invoke__">unwrap</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Step-6-Integrate-and-Return-the-Answer"><a href="#Step-6-Integrate-and-Return-the-Answer" class="headerlink" title="Step 6: Integrate and Return the Answer"></a>Step 6: Integrate and Return the Answer</h2><p>Arrange all subfunctions in the <code>main</code> function and print the value of <code>n - people_disjoint_set_union.get_largest_set()</code> as the result.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">n</span> = <span class="title function_ invoke__">read_line_of_i32</span>()[<span class="number">0</span>] <span class="keyword">as</span> <span class="type">usize</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">people</span> = <span class="title function_ invoke__">record_people</span>(n);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">lang_dict</span> = <span class="title function_ invoke__">build_language_dict</span>(&amp;people);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">lang_graph</span> = <span class="title function_ invoke__">build_lang_graph</span>(&amp;people, &amp;lang_dict);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">people_disjoint_set_union</span> =</span><br><span class="line">        <span class="title function_ invoke__">build_people_disjoint_set_union</span>(&amp;people, &amp;lang_graph, &amp;lang_dict);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, n - people_disjoint_set_union.<span class="title function_ invoke__">get_largest_set</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Conclusion-Complete-Code"><a href="#Conclusion-Complete-Code" class="headerlink" title="Conclusion: Complete Code"></a>Conclusion: Complete Code</h2><p>The provided code demonstrates a method for solving the problem by dividing people into sets based on language understanding and speaking, using data structures and algorithms such as hash maps, graphs, DFS, and disjoint set unions to efficiently find the minimum number of people that need to be excluded to allow for universal communication within the remaining group.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::&#123;</span><br><span class="line">    borrow::Borrow,</span><br><span class="line">    collections::&#123;HashMap, HashSet&#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    speak: <span class="type">String</span>,</span><br><span class="line">    understand: HashSet&lt;<span class="type">String</span>&gt;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">DisjointSetUnion</span> &#123;</span><br><span class="line">    fa: <span class="type">Vec</span>&lt;<span class="type">usize</span>&gt;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">DisjointSetUnion</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">get_fa</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, cur: <span class="type">usize</span>) <span class="punctuation">-&gt;</span> <span class="type">usize</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">self</span>.fa[cur] == cur &#123;</span><br><span class="line">            <span class="keyword">return</span> cur;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">tmp</span> = <span class="keyword">self</span>.fa[cur];</span><br><span class="line">        <span class="keyword">self</span>.fa[cur] = <span class="keyword">self</span>.<span class="title function_ invoke__">get_fa</span>(tmp);</span><br><span class="line">        <span class="keyword">self</span>.fa[cur]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">get_largest_set</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">usize</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">num_of_set</span> = <span class="built_in">vec!</span>[<span class="number">0usize</span>; <span class="keyword">self</span>.fa.<span class="title function_ invoke__">len</span>()];</span><br><span class="line">        <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">0</span>..<span class="keyword">self</span>.fa.<span class="title function_ invoke__">len</span>() &#123;</span><br><span class="line">            num_of_set[<span class="keyword">self</span>.<span class="title function_ invoke__">get_fa</span>(i)] += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        *num_of_set.<span class="title function_ invoke__">iter</span>().<span class="title function_ invoke__">max</span>().<span class="title function_ invoke__">unwrap</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">n</span> = <span class="title function_ invoke__">read_line_of_i32</span>()[<span class="number">0</span>] <span class="keyword">as</span> <span class="type">usize</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">people</span> = <span class="title function_ invoke__">record_people</span>(n);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">lang_dict</span> = <span class="title function_ invoke__">build_language_dict</span>(&amp;people);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">lang_graph</span> = <span class="title function_ invoke__">build_lang_graph</span>(&amp;people, &amp;lang_dict);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">people_disjoint_set_union</span> =</span><br><span class="line">        <span class="title function_ invoke__">build_people_disjoint_set_union</span>(&amp;people, &amp;lang_graph, &amp;lang_dict);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, n - people_disjoint_set_union.<span class="title function_ invoke__">get_largest_set</span>());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">build_people_disjoint_set_union</span>(</span><br><span class="line">    people: &amp;<span class="type">Vec</span>&lt;Person&gt;,</span><br><span class="line">    lang_graph: &amp;<span class="type">Vec</span>&lt;<span class="type">Vec</span>&lt;<span class="type">usize</span>&gt;&gt;,</span><br><span class="line">    lang_dict: &amp;HashMap&lt;&amp;<span class="type">String</span>, <span class="type">usize</span>&gt;,</span><br><span class="line">) <span class="punctuation">-&gt;</span> DisjointSetUnion &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">people_disjoint_set_union</span> = DisjointSetUnion &#123;</span><br><span class="line">        fa: (<span class="number">0</span>..people.<span class="title function_ invoke__">len</span>()).<span class="title function_ invoke__">into_iter</span>().<span class="title function_ invoke__">collect</span>(),</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">0</span>..people.<span class="title function_ invoke__">len</span>() &#123;</span><br><span class="line">        <span class="keyword">for</span> <span class="variable">j</span> <span class="keyword">in</span> i + <span class="number">1</span>..people.<span class="title function_ invoke__">len</span>() &#123;</span><br><span class="line">            <span class="keyword">if</span> people_disjoint_set_union.<span class="title function_ invoke__">get_fa</span>(i) == people_disjoint_set_union.<span class="title function_ invoke__">get_fa</span>(j)</span><br><span class="line">                || !<span class="title function_ invoke__">test_biconnected</span>(&amp;people[i], &amp;people[j], lang_graph, lang_dict)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">tmp</span> = people_disjoint_set_union.<span class="title function_ invoke__">get_fa</span>(i);</span><br><span class="line">            people_disjoint_set_union.fa[tmp] = people_disjoint_set_union.<span class="title function_ invoke__">get_fa</span>(j);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    people_disjoint_set_union</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">test_connected_dfs</span>(</span><br><span class="line">    cur: <span class="type">usize</span>,</span><br><span class="line">    target: &amp;HashSet&lt;<span class="type">usize</span>&gt;,</span><br><span class="line">    lang_graph: &amp;<span class="type">Vec</span>&lt;<span class="type">Vec</span>&lt;<span class="type">usize</span>&gt;&gt;,</span><br><span class="line">    visited: &amp;<span class="keyword">mut</span> <span class="type">Vec</span>&lt;<span class="type">bool</span>&gt;,</span><br><span class="line">) <span class="punctuation">-&gt;</span> <span class="type">bool</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> target.<span class="title function_ invoke__">contains</span>(&amp;cur) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    visited[cur] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">next</span> <span class="keyword">in</span> &amp;lang_graph[cur] &#123;</span><br><span class="line">        <span class="keyword">if</span> visited[*next] &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> <span class="title function_ invoke__">test_connected_dfs</span>(*next, target, lang_graph, visited) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">test_biconnected</span>(</span><br><span class="line">    a: &amp;Person,</span><br><span class="line">    b: &amp;Person,</span><br><span class="line">    lang_graph: &amp;<span class="type">Vec</span>&lt;<span class="type">Vec</span>&lt;<span class="type">usize</span>&gt;&gt;,</span><br><span class="line">    lang_dict: &amp;HashMap&lt;&amp;<span class="type">String</span>, <span class="type">usize</span>&gt;,</span><br><span class="line">) <span class="punctuation">-&gt;</span> <span class="type">bool</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">visited</span> = <span class="built_in">vec!</span>[<span class="literal">false</span>; lang_graph.<span class="title function_ invoke__">len</span>()];</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">target</span>: HashSet&lt;<span class="type">usize</span>&gt; = b</span><br><span class="line">        .understand</span><br><span class="line">        .<span class="title function_ invoke__">borrow</span>()</span><br><span class="line">        .<span class="title function_ invoke__">into_iter</span>()</span><br><span class="line">        .<span class="title function_ invoke__">map</span>(|s| lang_dict[s])</span><br><span class="line">        .<span class="title function_ invoke__">collect</span>();</span><br><span class="line">    <span class="keyword">if</span> !<span class="title function_ invoke__">test_connected_dfs</span>(lang_dict[&amp;a.speak], &amp;target, lang_graph, &amp;<span class="keyword">mut</span> visited) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    visited = <span class="built_in">vec!</span>[<span class="literal">false</span>; lang_graph.<span class="title function_ invoke__">len</span>()];</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">target</span>: HashSet&lt;<span class="type">usize</span>&gt; = a</span><br><span class="line">        .understand</span><br><span class="line">        .<span class="title function_ invoke__">borrow</span>()</span><br><span class="line">        .<span class="title function_ invoke__">into_iter</span>()</span><br><span class="line">        .<span class="title function_ invoke__">map</span>(|s| lang_dict[s])</span><br><span class="line">        .<span class="title function_ invoke__">collect</span>();</span><br><span class="line">    <span class="keyword">if</span> !<span class="title function_ invoke__">test_connected_dfs</span>(lang_dict[&amp;b.speak], &amp;target, lang_graph, &amp;<span class="keyword">mut</span> visited) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">build_lang_graph</span>(people: &amp;<span class="type">Vec</span>&lt;Person&gt;, lang_dict: &amp;HashMap&lt;&amp;<span class="type">String</span>, <span class="type">usize</span>&gt;) <span class="punctuation">-&gt;</span> <span class="type">Vec</span>&lt;<span class="type">Vec</span>&lt;<span class="type">usize</span>&gt;&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">lang_graph</span>: <span class="type">Vec</span>&lt;<span class="type">Vec</span>&lt;<span class="type">usize</span>&gt;&gt; = <span class="built_in">vec!</span>[<span class="built_in">vec!</span>[]; lang_dict.<span class="title function_ invoke__">len</span>()];</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">person</span> <span class="keyword">in</span> people &#123;</span><br><span class="line">        <span class="keyword">for</span> <span class="variable">lang</span> <span class="keyword">in</span> person.understand.<span class="title function_ invoke__">borrow</span>() &#123;</span><br><span class="line">            <span class="keyword">if</span> *lang == person.speak &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            lang_graph[lang_dict[lang]].<span class="title function_ invoke__">push</span>(lang_dict[&amp;person.speak]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">0</span>..lang_graph.<span class="title function_ invoke__">len</span>() &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">tmp</span>: HashSet&lt;_&gt; = lang_graph[i].<span class="title function_ invoke__">drain</span>(..).<span class="title function_ invoke__">collect</span>();</span><br><span class="line">        lang_graph[i].<span class="title function_ invoke__">extend</span>(tmp.<span class="title function_ invoke__">into_iter</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    lang_graph</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">build_language_dict</span>(people: &amp;<span class="type">Vec</span>&lt;Person&gt;) <span class="punctuation">-&gt;</span> HashMap&lt;&amp;<span class="type">String</span>, <span class="type">usize</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">lang_dict</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">num_of_lang</span> = <span class="number">0usize</span>;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">person</span> <span class="keyword">in</span> people &#123;</span><br><span class="line">        <span class="keyword">for</span> <span class="variable">lang</span> <span class="keyword">in</span> person.understand.<span class="title function_ invoke__">borrow</span>() &#123;</span><br><span class="line">            <span class="keyword">if</span> lang_dict.<span class="title function_ invoke__">contains_key</span>(lang) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            lang_dict.<span class="title function_ invoke__">insert</span>(lang, num_of_lang);</span><br><span class="line">            num_of_lang += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    lang_dict</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">record_people</span>(n: <span class="type">usize</span>) <span class="punctuation">-&gt;</span> <span class="type">Vec</span>&lt;Person&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">people</span>: <span class="type">Vec</span>&lt;Person&gt; = <span class="built_in">vec!</span>[];</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">_</span> <span class="keyword">in</span> <span class="number">0</span>..n &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">input</span> = <span class="title function_ invoke__">read_line_of_string</span>();</span><br><span class="line">        <span class="comment">// println!(&quot;&#123;:?&#125;&quot;, input);</span></span><br><span class="line">        people.<span class="title function_ invoke__">push</span>(Person &#123;</span><br><span class="line">            speak: input[<span class="number">1</span>].<span class="title function_ invoke__">to_owned</span>(),</span><br><span class="line">            understand: HashSet::<span class="title function_ invoke__">new</span>(),</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">id</span> = people.<span class="title function_ invoke__">len</span>() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">1</span>..input.<span class="title function_ invoke__">len</span>() &#123;</span><br><span class="line">            people[id].understand.<span class="title function_ invoke__">insert</span>(input[i].<span class="title function_ invoke__">clone</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    people</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">read_line_of_i32</span>() <span class="punctuation">-&gt;</span> <span class="type">Vec</span>&lt;<span class="type">i32</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">buffer</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">_</span> = std::io::<span class="title function_ invoke__">stdin</span>().<span class="title function_ invoke__">read_line</span>(&amp;<span class="keyword">mut</span> buffer);</span><br><span class="line">    buffer</span><br><span class="line">        .<span class="title function_ invoke__">trim</span>()</span><br><span class="line">        .<span class="title function_ invoke__">to_owned</span>()</span><br><span class="line">        .<span class="title function_ invoke__">split</span>(<span class="string">&quot; &quot;</span>)</span><br><span class="line">        .<span class="title function_ invoke__">map</span>(|x| x.<span class="title function_ invoke__">to_owned</span>().parse::&lt;<span class="type">i32</span>&gt;().<span class="title function_ invoke__">unwrap</span>())</span><br><span class="line">        .<span class="title function_ invoke__">collect</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">read_line_of_string</span>() <span class="punctuation">-&gt;</span> <span class="type">Vec</span>&lt;<span class="type">String</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">buffer</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">_</span> = std::io::<span class="title function_ invoke__">stdin</span>().<span class="title function_ invoke__">read_line</span>(&amp;<span class="keyword">mut</span> buffer);</span><br><span class="line">    buffer</span><br><span class="line">        .<span class="title function_ invoke__">trim</span>()</span><br><span class="line">        .<span class="title function_ invoke__">to_owned</span>()</span><br><span class="line">        .<span class="title function_ invoke__">split</span>(<span class="string">&quot; &quot;</span>)</span><br><span class="line">        .<span class="title function_ invoke__">map</span>(|x| x.<span class="title function_ invoke__">to_owned</span>())</span><br><span class="line">        .<span class="title function_ invoke__">collect</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>HuaiYuan Jing
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://dawn-cmd.github.io/2024/02/11/Solution-of-Cantina-of-Babel/" title="Solution of Cantina of Babel">https://dawn-cmd.github.io/2024/02/11/Solution-of-Cantina-of-Babel/</a>
  </li>
  <li class="post-copyright-license">
      <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


        
  <div class="social-like a2a_kit a2a_kit_size_32 a2a_default_style">
    <a class="a2a_dd" target="_blank" rel="external nofollow noopener noreferrer" href="https://www.addtoany.com/share"></a>
      <a class="a2a_button_facebook"></a>
      <a class="a2a_button_twitter"></a>
      <a class="a2a_button_linkedin"></a>
      <a class="a2a_button_telegram"></a>
  </div>

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/02/02/First-Step-of-Dynamic-Programming-From-Fibonacci-to-Matrix-Acceleration/" rel="prev" title="First Step of Dynamic Programming: From Fibonacci to Matrix Acceleration">
                  <i class="fa fa-angle-left"></i> First Step of Dynamic Programming: From Fibonacci to Matrix Acceleration
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">HuaiYuan Jing</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script size="300" alpha="0.6" zindex="-1" src="https://cdnjs.cloudflare.com/ajax/libs/ribbon.js/1.0.2/ribbon.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.28/fancybox/fancybox.umd.js" integrity="sha256-ytMJGN3toR+a84u7g7NuHm91VIR06Q41kMWDr2pq7Zo=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>

  <script src="/js/third-party/addtoany.js"></script>

  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
